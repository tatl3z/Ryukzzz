import type { CorePluginList } from './generated/corePluginList'
import type { DefaultColors } from './generated/colors'

// Helpers
type Expand<T> = T extends object
  ? T extends infer O
    ? { [K in keyof O]: Expand<O[K]> }
    : never
  : T
type KeyValuePair<K extends keyof any = string, V = string> = Record<K, V>
interface RecursiveKeyValuePair<K extends keyof any = string, V = string> {
  [key: string]: V | RecursiveKeyValuePair<K, V>
}
export type ResolvableTo<T> = T | ((utils: PluginUtils) => T)
type CSSRuleObject = RecursiveKeyValuePair<string, null | string | string[]>

interface PluginUtils {
  colors: DefaultColors
  theme(path: string, defaultValue?: unknown): any
  breakpoints<I = Record<string, unknown>, O = I>(arg: I): O
  rgb(arg: string): (arg: Partial<{ opacityVariable: string; opacityValue: number }>) => string
  hsl(arg: string): (arg: Partial<{ opacityVariable: string; opacityValue: number }>) => string
}

// Content related config
type FilePath = string
type RawFile = { raw: string; extension?: string }
type ExtractorFn = (content: string) => string[]
type TransformerFn = (content: string) => string
type ContentConfig =
  | (FilePath | RawFile)[]
  | {
      files: (FilePath | RawFile)[]
      relative?: boolean
      extract?: ExtractorFn | { [extension: string]: ExtractorFn }
      transform?: TransformerFn | { [extension: string]: TransformerFn }
    }

// Important related config
type ImportantConfig = boolean | string

// Prefix related config
type PrefixConfig = string

// Separator related config
type SeparatorConfig = string

// Safelist related config
type SafelistConfig = string | { pattern: RegExp; variants?: string[] }

// Blocklist related config
type BlocklistConfig = string

// Presets related config
type PresetsConfig = Partial<Config>

// Future related config
type FutureConfigValues =
  | 'hoverOnlyWhenSupported'
  | 'respectDefaultRingColorOpacity'
  | 'disableColorOpacityUtilitiesByDefault'
  | 'relativeContentPathsByDefault'
type FutureConfig = Expand<'all' | Partial<Record<FutureConfigValues, boolean>>> | []

// Experimental related config
type ExperimentalConfigValues = 'optimizeUniversalDefaults' | 'matchVariant'
type ExperimentalConfig = Expand<'all' | Partial<Record<ExperimentalConfigValues, boolean>>> | []

// DarkMode related config
type DarkModeConfig =
  // Use the `media` query strategy.
  | 'media'
  // Use the `class` strategy, which requires a `.dark` class on the `html`.
  | 'class'
  // Use the `class` strategy with a custom class instead of `.dark`.
  | ['class', string]
  // Use the `selector` strategy â€” same as `class` but uses `:where()` for more predicable behavior
  | 'selector'
  // Use the `selector` strategy with a custom selector instead of `.dark`.
  | ['selector', string]
  // Use the `variant` strategy, which allows you to completely customize the selector
  // It takes a string or an array of strings, which are passed directly to `addVariant()`
  | ['variant', string | string[]]

type Screen = { raw: string } | { min: string } | { max: string } | { min: string; max: string }
type ScreensConfig = string[] | KeyValuePair<string, string | Screen | Screen[]>

// Theme related config
export interface ThemeConfig {
  // Responsiveness
  screens: ResolvableTo<ScreensConfig>
  supports: ResolvableTo<Record<string, string>>
  data: ResolvableTo<Record<string, string>>

  // Reusable base configs
  colors: ResolvableTo<RecursiveKeyValuePair>
  spacing: ResolvableTo<KeyValuePair>

  // Components
  container: ResolvableTo<
    Partial<{
      screens: ScreensConfig
      center: boolean
      padding: string | Record<string, string>
    }>
  >

  // Utilities
  inset: ThemeConfig['spacing']
  zIndex: ResolvableTo<KeyValuePair>
  order: ResolvableTo<KeyValuePair>
  gridColumn: ResolvableTo<KeyValuePair>
  gridColumnStart: ResolvableTo<KeyValuePair>
  gridColumnEnd: ResolvableTo<KeyValuePair>
  gridRow: ResolvableTo<KeyValuePair>
  gridRowStart: ResolvableTo<KeyValuePair>
  gridRowEnd: ResolvableTo<KeyValuePair>
  margin: ThemeConfig['spacing']
  aspectRatio: ResolvableTo<KeyValuePair>
  height: ThemeConfig['spacing']
  maxHeight: ThemeConfig['spacing']
  minHeight: ResolvableTo<KeyValuePair>
  width: ThemeConfig['spacing']
  maxWidth: ResolvableTo<KeyValuePair>
  minWidth: ResolvableTo<KeyValuePair>
  flex: ResolvableTo<KeyValuePair>
  flexShrink: ResolvableTo<KeyValuePair>
  flexGrow: ResolvableTo<KeyValuePair>
  flexBasis: ThemeConfig['spacing']
  borderSpacing: ThemeConfig['spacing']
  transformOrigin: ResolvableTo<KeyValuePair>
  translate: ThemeConfig['spacing']
  rotate: ResolvableTo<KeyValuePair>
  skew: ResolvableTo<KeyValuePair>
  scale: ResolvableTo<KeyValuePair>
  animation: ResolvableTo<KeyValuePair>
  keyframes: ResolvableTo<KeyValuePair<string, KeyValuePair<string, KeyValuePair>>>
  cursor: ResolvableTo<KeyValuePair>
  scrollMargin: ThemeConfig['spacing']
  scrollPadding: ThemeConfig['spacing']
  listStyleType: ResolvableTo<KeyValuePair>
  columns: ResolvableTo<KeyValuePair>
  gridAutoColumns: ResolvableTo<KeyValuePair>
  gridAutoRows: ResolvableTo<KeyValuePair>
  gridTemplateColumns: ResolvableTo<KeyValuePair>
  gridTemplateRows: ResolvableTo<KeyValuePair>
  gap: ThemeConfig['spacing']
  space: ThemeConfig['spacing']
  divideWidth: ThemeConfig['borderWidth']
  divideColor: ThemeConfig['borderColor']
  divideOpacity: ThemeConfig['borderOpacity']
  borderRadius: ResolvableTo<KeyValuePair>
  borderWidth: ResolvableTo<KeyValuePair>
  borderColor: ThemeConfig['colors']
  borderOpacity: ThemeConfig['opacity']
  backgroundColor: ThemeConfig['colors']
  backgroundOpacity: ThemeConfig['opacity']
  backgroundImage: ResolvableTo<KeyValuePair>
  gradientColorStops: ThemeConfig['colors']
  backgroundSize: ResolvableTo<KeyValuePair>
  backgroundPosition: ResolvableTo<KeyValuePair>
  fill: ThemeConfig['colors']
  stroke: ThemeConfig['colors']
  strokeWidth: ResolvableTo<KeyValuePair>
  objectPosition: ResolvableTo<KeyValuePair>
  padding: ThemeConfig['spacing']
  textIndent: ThemeConfig['spacing']
  fontFamily: ResolvableTo<
    KeyValuePair<
      string,
      | string
      | string[]
      | [
          fontFamily: string | string[],
          configuration: Partial<{
            fontFeatureSettings: string
            fontVariationSettings: string
          }>
        ]
    >
  >
  fontSize: ResolvableTo<
    KeyValuePair<
      string,
      | string
      | [fontSize: string, lineHeight: string]
      | [
          fontSize: string,
          configuration: Partial<{
            lineHeight: string
            letterSpacing: string
            fontWeight: string | number
          }>
        ]
    >
  >
  fontWeight: ResolvableTo<KeyValuePair>
  lineHeight: ResolvableTo<KeyValuePair>
  letterSpacing: ResolvableTo<KeyValuePair>
  textColor: ThemeConfig['colors']
  textOpacity: ThemeConfig['opacity']
  textDecorationColor: ThemeConfig['colors']
  textDecorationThickness: ResolvableTo<KeyValuePair>
  textUnderlineOffset: ResolvableTo<KeyValuePair>
  placeholderColor: ThemeConfig['colors']
  placeholderOpacity: ThemeConfig['opacity']
  caretColor: ThemeConfig['colors']
  accentColor: ThemeConfig['colors']
  opacity: ResolvableTo<KeyValuePair>
  boxShadow: ResolvableTo<KeyValuePair<string, string | string[]>>
  boxShadowColor: ThemeConfig['colors']
  outlineWidth: ResolvableTo<KeyValuePair>
  outlineOffset: ResolvableTo<KeyValuePair>
  outlineColor: ThemeConfig['colors']
  ringWidth: ResolvableTo<KeyValuePair>
  ringColor: ThemeConfig['colors']
  ringOpacity: ThemeConfig['opacity']
  ringOffsetWidth: ResolvableTo<KeyValuePair>
  ringOffsetColor: ThemeConfig['colors']
  blur: ResolvableTo<KeyValuePair>
  brightness: ResolvableTo<KeyValuePair>
  contrast: ResolvableTo<KeyValuePair>
  dropShadow: ResolvableTo<KeyValuePair<string, string | string[]>>
  grayscale: ResolvableTo<KeyValuePair>
  hueRotate: ResolvableTo<KeyValuePair>
  invert: ResolvableTo<KeyValuePair>
  saturate: ResolvableTo<KeyValuePair>
  sepia: ResolvableTo<KeyValuePair>
  backdropBlur: ThemeConfig['blur']
  backdropBrightness: ThemeConfig['brightness']
  backdropContrast: ThemeConfig['contrast']
  backdropGrøÿÿÿ¸ïYèÿÿÿvk  N   0òY       øÿÿÿØïYøÿÿÿóYhbin ðY                       ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<        ˆòYÿÿÿÿ   ÐïY@\  ÿÿÿÿ            0      &   {0F223F8F-F220-5388-8FE6-B3B7E7930987}  Èþÿÿ_ _ F I T y p e d E v e n t H a n d l e r _ 2 _ W i n d o w s _ _ C U I _ _ C I n p u t _ _ C S p a t i a l _ _ C S p a t i a l I n t e r a c t i o n M a n a g e r _ W i n d o w s _ _ C U I _ _ C I n p u t _ _ C S p a t i a l _ _ C S p a t i a l I n t e r a c t i o n D e t e c t e d E v e n t A r g s        ÿÿÿnk  =]EÞÞ¬Õ    ðY        ÿÿÿÿÿÿÿÿ   ðïY@\  ÿÿÿÿ            N          ProxyStubClsid32¨ÿÿÿ{ A A F 3 2 2 D 7 - 7 9 5 E - 4 4 8 5 - A 9 2 F - 3 D 3 F 3 9 2 6 9 E D E }         ðÿÿÿlh ÐñYüC¶»ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<        ôYÿÿÿÿ   øïY@\  ÿÿÿÿ                   &   {0F240708-629A-31AB-94A5-2BB476FE1783}  èÿÿÿvk     (óY       èÿÿÿ_ R a n d o m        ÿÿÿnk  =]EÞÞ¬Õ   ˜òY        ÿÿÿÿÿÿÿÿ   ôYx• ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   ¸óY       ¨ÿÿÿ{ 0 0 0 2 0 4 2 4 - 0 0 0 0 - 0 0 0 0 - C 0 0 0 - 0 0 0 0 0 0 0 0 0 0 4 6 }         øÿÿÿ óYèÿÿÿlh @óYüC¶»0ôY×§¨ÿÿÿnk  =]EÞÞ¬Õ   ˜òY        ÿÿÿÿÿÿÿÿ   øôYx• ÿÿÿÿ           N          TypeLib èÿÿÿvk  N    ôY      ¨ÿÿÿ{ B E D 7 F 4 E A - 1 A 9 6 - 1 1 D 2 - 8 F 0 8 - 0 0 A 0 C 9 A 6 1 8 6 D }         ðÿÿÿˆôYõY    àÿÿÿvk    (õY     Version ðÿÿÿ2 . 4       ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<        àöYÿÿÿÿ    öY@\  ÿÿÿÿ            .       &   {0f2495e9-edd6-46ef-a1f3-36713f4b5114}  èÿÿÿvk  .   ÈõY       ÈÿÿÿI F a m i l y S e t t i n g s S t a t i c s         øÿÿÿ°õY ÿÿÿnk  =]EÞÞ¬Õ   8õY        ÿÿÿÿÿÿÿÿ   ØöYx• ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   €öY     €?¨ÿÿÿ{ D 2 E D 2 6 0 C - 3 8 F 1 - 4 A B E - 8 B 2 B - D 4 A 0 8 8 C 5 4 4 1 6 }         øÿÿÿhöYðÿÿÿlh öYüC¶»ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<        ˜øYÿÿÿÿ   ¸÷Y@\  ÿÿÿÿ            0       &   {0F2AD8FA-BAB1-4AD8-A41F-952DB538A247}  èÿÿÿvk  0   €÷Y      ÈÿÿÿI I s M a p p i n g V a l i d C a l l b a c k       øÿÿÿh÷Y ÿÿÿnk  =]EÞÞ¬Õ   ðöY        ÿÿÿÿÿÿÿÿ   øY@\  ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   8øY       ¨ÿÿÿ{ 9 5 E 1 5 D 0 A - 6 6 E 6 - 9 3 D 9 - C 5 3 C - 7 6 E 6 2 1 9 D 3 3 4 1 }         øÿÿÿ øYðÿÿÿlh À÷YüC¶»ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<        øùYÿÿÿÿ    ÿÿÿÿ@\  ÿÿÿÿ                    &   {0F2CE2B7-AFA7-5ED0-8CB6-8C40CF9B3A5F}   ÿÿÿnk  =]EÞÞ¬Õ   ¨øY        ÿÿÿÿÿÿÿÿ   ðùYx• ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   ˜ùY       ¨ÿÿÿ{ 5 2 4 b 3 5 0 e - a 2 8 a - 4 2 5 d - a 4 7 2 - c 9 e 2 e 2 c 8 7 b f d }         øÿÿÿ€ùYðÿÿÿlh  ùYüC¶»ˆÿÿÿnk  Ì«}0ß¬Õ   ðÎ<        ¨ûYÿÿÿÿ   ÈúY˜  ÿÿÿÿ            *       &   {0F2D35B3-DB34-4966-BEA6-59C7CD203862}  èÿÿÿvk  *   ˜úY       ÐÿÿÿI L a y e r C o m m a n d H a n d l e r     øÿÿÿ€úY ÿÿÿnk  Ì«}0ß¬Õ   úY        ÿÿÿÿÿÿÿÿ    ûY˜  ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   HûY       ¨ÿÿÿ{ A 4 A 1 A 1 2 8 - 7 6 8 F - 4 1 E 0 - B F 7 5 - E 4 F D D D 7 0 1 C B A }         øÿÿÿ0ûYðÿÿÿlh ÐúYüC¶»ˆÿÿÿnk  =]EÞÞ¬Õ   ðÎ<         ýYÿÿÿÿ   ÀüY@\  ÿÿÿÿ            r       &   {0f2f217e-7957-4262-a74c-df03d9e9e9c1}  èÿÿÿvk  r   HüY       ˆÿÿÿ_ _ x _ W i n d o w s _ C I n t e r n a l _ C S t a t e R e p o s i t o r y _ C I P r o t o c o l S t a t i c s     øÿÿÿ0üY ÿÿÿnk  =]EÞÞ¬Õ   ¸ûY        ÿÿÿÿÿÿÿÿ   ˜ýYx• ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   @ýY       ¨ÿÿÿ{ c 5 3 e 0 7 e c - 2 5 f 3 - 4 0 9 3 - a a 3 9 - f c 6 7 e a 2 2 e 9 9 d }         øÿÿÿ(ýYðÿÿÿlh ÈüYüC¶»ˆÿÿÿnk  ëäBÞÞ¬Õ   ðÎ<        pÿYÿÿÿÿ   þY@\  ÿÿÿÿ            J       &   {0F2F3758-8EC7-4381-922B-8F6C07D288F3}  èÿÿÿvk  J   @þY       °ÿÿÿ_ _ x _ W i n d o w s _ C S t o r a g e _ C I P a t h I O S t a t i c s     øÿÿÿ(þY ÿÿÿnk  =]EÞÞ¬Õ   °ýY        ÿÿÿÿÿÿÿÿ   hÿY@\  ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   ÿY     —ñ¨ÿÿÿ{ 9 5 E 1 5 D 0 A - 6 6 E 6 - 9 3 D 9 - C 5 3 C - 7 6 E 6 2 1 9 D 3 3 4 1 }         øÿÿÿøþYðÿÿÿlh ˜þYüC¶»ˆÿÿÿnk  ëäBÞÞ¬Õ   ðÎ<        ¨Zÿÿÿÿ   øÿY@\  ÿÿÿÿ            Ž       &   {0F3121AC-D609-51A1-96F3-FB00D1819252}  øÿÿÿ  Zhbin  Z                       èÿÿÿvk  Ž   8 Z      hÿÿÿ_ _ x _ W i n d o w s _ C A p p l i c a t i o n M o d e l _ C C a l l s _ C I P h o n e L i n e T r a n s p o r t D e v i c e S t a t i c s          ÿÿÿnk  ëäBÞÞ¬Õ   €ÿY        ÿÿÿÿÿÿÿÿ    Z@\  ÿÿÿÿ            N          ProxyStubClsid32èÿÿÿvk  N   HZ       ¨ÿÿÿ{ 9 5 E 1 5 D 0 A - 6 6 E 6 - 9 3 D 9 - C 5 3 C - 7 6 E 6 2 1 9 D 3 3 4 1 }        